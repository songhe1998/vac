import matplotlib.pyplot as plt
import numpy as np

probs = [0.988602876663208, 0.993303120136261, 0.9796336889266968, 0.9381429553031921, 0.8772763609886169, 0.8781819343566895, 0.9032866358757019, 0.9291680455207825, 0.9068425297737122, 0.8686614632606506, 0.834563136100769, 0.706997811794281, 0.5762218236923218, 0.49074387550354004, 0.41996094584465027, 0.4366496801376343, 0.353841096162796, 0.13939957320690155, 0.19283773005008698, 0.2615503668785095, 0.2696988582611084, 0.23088626563549042, 0.2522193193435669, 0.24944360554218292, 0.2427370548248291, 0.31630825996398926, 0.23204924166202545, 0.20222654938697815, 0.16917110979557037, 0.14385521411895752, 0.1645718812942505, 0.2534328103065491, 0.2791127860546112, 0.32369574904441833, 0.3059292733669281, 0.20975005626678467, 0.2131798267364502, 0.3269152343273163, 0.43246614933013916, 0.47044169902801514, 0.4503031373023987, 0.5523911118507385, 0.7416341304779053, 0.8341879844665527, 0.6325781941413879, 0.34194737672805786, 0.6787870526313782, 0.7416058778762817, 0.818472146987915, 0.920690655708313, 0.9296699166297913, 0.9394172430038452, 0.9694544672966003, 0.9514307379722595, 0.906191349029541, 0.7988458871841431, 0.6003209948539734, 0.3704185485839844, 0.43520981073379517, 0.46393319964408875, 0.46901044249534607, 0.43629947304725647, 0.4929291903972626, 0.31880706548690796, 0.3261125087738037, 0.29698872566223145, 0.30636024475097656, 0.3274103105068207, 0.26346081495285034, 0.3962421417236328, 0.310462087392807, 0.3278164863586426, 0.25652778148651123, 0.1944667100906372, 0.2533823251724243, 0.3222185969352722, 0.4029461443424225, 0.4055425822734833, 0.7151196599006653, 0.9438800811767578, 0.9330746531486511, 0.885924756526947, 0.823839008808136, 0.797320544719696, 0.7322463989257812, 0.6387059688568115, 0.6525147557258606, 0.6561621427536011, 0.5888617038726807, 0.4390704929828644, 0.2828879654407501, 0.3891464173793793, 0.41265955567359924, 0.38071340322494507, 0.38885411620140076, 0.3592189848423004, 0.41401374340057373, 0.39966002106666565, 0.3658406734466553, 0.2734001874923706, 0.2939947843551636, 0.2863345444202423, 0.3689252436161041, 0.3267329931259155, 0.3329971432685852, 0.34549397230148315, 0.333484411239624, 0.41680899262428284, 0.29666298627853394, 0.33311155438423157, 0.6232801675796509, 0.5056687593460083, 0.38999122381210327, 0.4036301374435425, 0.6512451767921448, 0.3837309777736664, 0.4702446758747101, 0.5088692903518677, 0.5432496666908264, 0.5245970487594604, 0.3736584484577179, 0.5731506943702698, 0.6819359064102173, 0.7619850635528564, 0.7547166347503662, 0.7099491357803345, 0.6213803291320801, 0.5359057784080505, 0.48830920457839966, 0.48279646039009094, 0.4298195242881775, 0.4474982023239136, 0.4543931782245636, 0.4874792993068695, 0.5079920291900635, 0.49103671312332153, 0.4431256651878357, 0.2447517216205597, 0.34117597341537476, 0.49967947602272034, 0.51902174949646, 0.41555294394493103, 0.4853888750076294, 0.606428325176239, 0.5755718350410461, 0.39078256487846375, 0.4913644790649414, 0.4707203805446625, 0.5686388611793518, 0.6609938740730286, 0.8095261454582214, 0.8733064532279968, 0.8563944697380066, 0.8096276521682739, 0.8579732775688171, 0.8476142883300781, 0.9387619495391846, 0.9338710904121399, 0.9472083449363708, 0.9356985688209534, 0.9315720796585083, 0.9522963166236877, 0.9486073851585388, 0.9301912784576416, 0.9318570494651794, 0.9322379231452942, 0.9401302933692932, 0.9345530271530151, 0.9488744139671326, 0.9585123658180237, 0.9630561470985413, 0.9565116167068481, 0.9433848261833191, 0.9156116843223572, 0.8493333458900452, 0.7641368508338928, 0.5882004499435425, 0.4041217863559723, 0.4043859541416168, 0.5350579619407654, 0.5685604810714722, 0.301380455493927, 0.3724144995212555, 0.48760244250297546, 0.5162654519081116, 0.587373673915863, 0.32636842131614685, 0.43600282073020935, 0.37984439730644226, 0.24557536840438843, 0.2705480456352234, 0.22221016883850098, 0.2598400413990021, 0.35290011763572693, 0.38229140639305115, 0.4003340005874634, 0.3376602828502655, 0.33455219864845276, 0.32940658926963806, 0.3289050757884979, 0.3012925684452057, 0.3341745138168335, 0.288518488407135, 0.29184719920158386, 0.2884051501750946, 0.2335827797651291, 0.248014897108078, 0.3090011179447174, 0.3915451169013977, 0.41146284341812134, 0.36834216117858887, 0.29445353150367737, 0.295188307762146, 0.28086715936660767, 0.27755850553512573, 0.33659327030181885, 0.6804843544960022, 0.941267192363739, 0.9817987084388733, 0.9914458990097046, 0.9955106973648071, 0.9926856756210327, 0.995502769947052, 0.9948635697364807, 0.9958088397979736, 0.9962357878684998, 0.9978564381599426, 0.9976139068603516, 0.9976428151130676, 0.9962614178657532, 0.9966554641723633, 0.9951887130737305, 0.9920503497123718, 0.9959880709648132, 0.9974324107170105, 0.9927194118499756, 0.9881669878959656, 0.97955322265625, 0.9487020969390869, 0.819072961807251, 0.5885443687438965, 0.24392539262771606, 0.20536084473133087, 0.2362942397594452, 0.1297864466905594, 0.47489526867866516, 0.6618642807006836, 0.8015453219413757, 0.8619720935821533, 0.8109528422355652, 0.8446338772773743, 0.868571937084198, 0.8665290474891663, 0.8781841397285461, 0.8826526403427124, 0.8644453287124634, 0.8032561540603638, 0.6411190629005432, 0.5874836444854736, 0.377620667219162, 0.38758665323257446, 0.3218044638633728, 0.2904205322265625, 0.2912696897983551, 0.4002258777618408, 0.43920931220054626, 0.42347317934036255, 0.6501157283782959, 0.876599907875061, 0.9290136694908142]
probs = [0.8603233098983765, 0.9898191094398499, 0.9930671453475952, 0.9819013476371765, 0.9546074271202087, 0.9727003574371338, 0.9879568219184875, 0.9958359003067017, 0.9973701238632202, 0.9962711334228516, 0.9985155463218689, 0.9987263083457947, 0.9982328414916992, 0.9960069060325623, 0.9965862035751343, 0.9947676658630371, 0.988923966884613, 0.9741734862327576, 0.937248170375824, 0.8403670191764832, 0.4851714074611664, 0.7681401371955872, 0.8238645792007446, 0.7029323577880859, 0.5930835604667664, 0.44068166613578796, 0.5028994679450989, 0.6445784568786621, 0.7190887331962585, 0.7977120280265808, 0.7627559304237366, 0.7662277817726135, 0.621209979057312, 0.5072448253631592, 0.3703029155731201, 0.4830276668071747, 0.7978043556213379, 0.7405218482017517, 0.8041165471076965, 0.7496905326843262, 0.5870567560195923, 0.44271183013916016, 0.3509017527103424, 0.27164557576179504, 0.2332589030265808, 0.32830810546875, 0.3681625723838806, 0.40974685549736023, 0.4292661249637604, 0.366654634475708, 0.2463836669921875, 0.21748439967632294, 0.2724264860153198, 0.2815837264060974, 0.28023797273635864, 0.29569298028945923, 0.29136383533477783, 0.28724804520606995, 0.2350504994392395, 0.24182914197444916, 0.2274264693260193, 0.2087099552154541, 0.24073700606822968, 0.20192065834999084, 0.20418959856033325, 0.28316718339920044, 0.24687206745147705, 0.18469280004501343, 0.24901458621025085, 0.22489570081233978, 0.37505266070365906, 0.6257929801940918, 0.8346697688102722, 0.930325984954834, 0.9616733193397522, 0.9916025996208191, 0.9948862195014954, 0.9963425993919373, 0.9939237236976624, 0.9856418967247009, 0.9775075316429138, 0.9565109014511108, 0.9560701251029968, 0.960324227809906, 0.9742259979248047, 0.9783822298049927, 0.9879289865493774, 0.9901856184005737, 0.9851519465446472, 0.9733669757843018, 0.9709171652793884, 0.9371193647384644, 0.8828024864196777, 0.7711923122406006, 0.5880030393600464, 0.38179856538772583, 0.27538129687309265, 0.2985610365867615, 0.3118284046649933, 0.18690310418605804, 0.24576890468597412, 0.33279338479042053, 0.28780481219291687, 0.28881657123565674, 0.2616308033466339, 0.3261469602584839, 0.37243854999542236, 0.35556745529174805, 0.3283154368400574, 0.38625550270080566, 0.37443700432777405, 0.3972774147987366, 0.4131905734539032, 0.41722187399864197, 0.4789585769176483, 0.5064236521720886, 0.5170336365699768, 0.5306265354156494, 0.5967073440551758, 0.6074067950248718, 0.6136558055877686, 0.646729588508606, 0.6588801145553589, 0.6846880912780762, 0.7016057372093201, 0.6989045143127441, 0.7055020332336426, 0.7205095887184143]

def plot_var_scaled(probs, window_size=15):
    probs_var = []
    
    for i in range(len(probs)-window_size):
        arr = probs[i:i+window_size]
        var = np.var(arr)
        probs_var.append(var)

    scale = np.mean(probs) / np.mean(probs_var)
    probs_var = np.array(probs_var) * scale
    probs_var = []
    for i in range(len(probs)-window_size):
        arr = probs[i:i+window_size]
        var = np.var(arr)
        scaled_var_prob = np.mean(arr) - var
        probs_var.append(scaled_var_prob)

    plt.plot(probs_var)
    plt.savefig(f'probs_sliding_var_scaled_{window_size}.png')


def plot_probs(probs, window_size=15):
    avg_probs = []
    for i in range(len(probs)-window_size):
        arr = probs[i:i+window_size]
        avg_prob = np.mean(arr)
        avg_probs.append(avg_prob)
    plt.plot(avg_probs)
    plt.savefig(f'probs_sliding_prob_{window_size}.png')


def plot_var(probs, window_size=15):
    probs_var = []
    
    for i in range(len(probs)-window_size):
        arr = probs[i:i+window_size]
        var = np.var(arr)
        probs_var.append(var)
    plt.plot(probs_var)
    plt.savefig(f'probs_sliding_var_{window_size}.png')






